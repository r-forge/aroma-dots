sets[[1]]$name <- "CRMA,h=2.000"
sets[[1]]$name <- "CRMA,h=4.000"
sets[[3]]$name <- "CRMA,h=3.000"
sets[[5]]$name <- "CRMA,h=2.000"
sets[[6]]$name <- "dChip,h=2.000"
sets[[4]]$name <- "dChip,h=3.000"
sets[[2]]$name <- "dChip,h=4.000"
dev.off()
source("roc.Rex")
source("roc.Rex")
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
for (kk in seq(along=sets)) sets[[kk]]$roc <- NULL
for (kk in seq(along=sets)) sets[[kk]]$auc <- NULL
dev.off(); source("roc.Rex")
str(sets[[1]]$roc)
for (kk in seq(along=sets)) sets[[kk]]$roc <- NULL
for (kk in seq(along=sets)) sets[[kk]]$auc <- NULL
source("roc.Rex")
dev.off()
source("roc.Rex")
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
autocorr
library(nlme)
ACF
methods("ACF")
getAnywhere("ACF.lme")
help.start(FALSE)
library(ts)
acf(sets[[1]]$M[keep,1])
x <- sets[[1]]$M[keep,1]
str(keep)
str(sets[[1]])
#acf(sets[[1]]$M[keep,1])
names(sets)
acf(sets[[8]]$M[keep,1])
lh
acf(lh)
acf(sets[[8]]$M[keep,1])
acf(sets[[7]]$M[keep,1])
acf(na.omit(sets[[7]]$M[keep,1]))
acf(na.omit(sets[[6]]$M[keep,1]))
acf(na.omit(sets[[6]]$M[,1]))
set <- sets[[6]]; acf(na.omit(set$M[(set$x > 2.8e6),1]))
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),1]))
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),1]))
set <- sets[[3]]; acf(na.omit(set$M[(set$x > 2.8e6),1]))
set <- sets[[3]]; acf(na.omit(set$M[(set$x > 2.8e6),1]), type="covariance")
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),1]), type="covariance")
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),1]), type="partial")
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),1]), lag.max=15, type="partial")
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),1]), lag.max=15, type="cor")
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),2]), lag.max=15, type="cor")
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),3]), lag.max=15)
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[1]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),1]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),5]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),6]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),7]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),8]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),9]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),10]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),11]), lag.max=15)
set <- sets[[2]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[3]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[5]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[6]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[7]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
set <- sets[[6]]; acf(na.omit(set$M[(set$x > 2.8e6),4]), lag.max=15)
names(sets)
set <- sets[[7]]
ff <- findTpAtFp(truth[keep,cc], sets[[7]]$M[keep,cc], fpRate=0.01, verbose=verbose); ff
str(truth)
str(keep)
keep <- (x > 2.8e6)
str(keep)
ff <- findTpAtFp(truth[keep,cc], sets[[7]]$M[keep,cc], fpRate=0.01, verbose=verbose); ff$tpRate
str(cc)
names(sets)
ff <- findTpAtFp(truth[keep,cc], sets[[5]]$M[keep,cc], fpRate=0.01, verbose=verbose); ff$tpRate
set <- sets[[5]]; ff <- findTpAtFp(set$truth[keep,cc], set$M[keep,cc], fpRate=0.01, verbose=verbose); ff$tpRate
set <- sets[[5]]; keep <- (set$x > 2.8e6); ff <- findTpAtFp(set$truth[keep,cc], set$M[keep,cc], fpRate=0.01, verbose=verbose); ff$tpRate
ff
str(set$roc)
ff <- findTpAtFp(set$truth[keep,cc], set$M[keep,cc], fpRate=0.01, verbose=verbose); ff$tpRate
fit2 <- fitRoc(set$truth[keep,cc], set$M[keep,cc], fpRate=0.01, verbose=verbose);
fit2 <- fitRoc(set$truth[keep,cc], set$M[keep,cc], verbose=verbose);
fit2 <- fitRoc(set$truth[keep,cc], set$M[keep,cc]);
str(fit2)
uu <- (0.009 < fit2@spec & fit2@spec < 0.011)
uu <- which(0.009 < fit2@spec & fit2@spec < 0.011)
uu
fit2@sens[uu]
plot.rocc
plot(fit2)
uu <- which(0.009 < 1-fit2@spec & 1-fit2@spec < 0.011)
uu
fit2@sens[uu]
class(fit2)
getAnywhere(plot.rocc)
methods("plot")
dev.off()
dev.off(); source("roc.Rex")
source("roc.Rex")
gc()
dev.off(); source("roc.Rex")
x11(); plot(fit2, xlim=c(0,0.06), ylim=c(0.94,1))
  abline(h=seq(0,1,by=by), lty=3, lwd=1);
  abline(v=seq(0,1,by=by), lty=3, lwd=1);
class(fit2)
getMethod("plot", "rocc")
methods("plot")
plot.spec
names(sets)
plot(sets[[5]]@roc)
plot(sets[[5]]$roc)
plot(sets[[5]]$roc);   abline(h=seq(0,1,by=by), lty=3, lwd=1);   abline(v=seq(0,1,by=by), lty=3, lwd=1);
plot(sets[[5]]$roc, xlim=c(0,0.6), ylim=c(0.94,1));   abline(h=seq(0,1,by=by), lty=3, lwd=1);   abline(v=seq(0,1,by=by), lty=3, lwd=1);
plot(sets[[5]]$roc, xlim=c(0,0.06), ylim=c(0.94,1));   abline(h=seq(0,1,by=by), lty=3, lwd=1);   abline(v=seq(0,1,by=by), lty=3, lwd=1);
set <- sets[[5]]
fit2 <- fitRoc(set$truth[keep,cc], set$M[keep,cc]);
strKeep)
str(keep)
keep <- (x > 2.8e6)
keep <- (x > 2.8e6)
fit2 <- fitRoc(set$truth[keep,cc], set$M[keep,cc]);
keep <- (set$x > 2.8e6)
fit2 <- fitRoc(set$truth[keep,cc], set$M[keep,cc]);
x11(); plot(fit2, xlim=c(0,0.06), ylim=c(0.94,1))
toCall
fit2 <- fitRoc(set$truth[keep,cc], set$M[keep,cc], toCall=toCall);
fit2 <- fitRoc(set$truth[keep,cc], set$M[keep,cc], call=toCall);
x11(); plot(fit2, xlim=c(0,0.06), ylim=c(0.94,1))
ff <- findTpAtFp(set$truth[keep,cc], set$M[keep,cc], fpRate=0.01, call=toCall, verbose=verbose); ff$tpRate
set <- sets[[6]]; ff <- findTpAtFp(set$truth[keep,cc], set$M[keep,cc], fpRate=0.01, call=toCall, verbose=verbose); ff$tpRate
set <- sets[[6]]; ff <- findTpAtFp(set$truth[keep,cc], set$M[keep,cc], fpRate=0.01, call=toCall); ff$tpRate
set <- sets[[5]]; ff <- findTpAtFp(set$truth[keep,cc], set$M[keep,cc], fpRate=0.01, call=toCall); ff$tpRate
rm(sets)
rm(sets0)
gc()
dev.off(); source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
names(sets[[1]])
sets[[1]][["hTp_0.0100"]]
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
sets[[2]][["hTp_0.0100"]]
sets[[3]][["hTp_0.0100"]]
sets[[4]][["hTp_0.0100"]]
sets[[1]][["hTp_0.0100"]][29,]
sets[[2]][["hTp_0.0100"]][29,]
sets[[3]][["hTp_0.0100"]][29,]
sets[[4]][["hTp_0.0100"]][29,]
nn <- 2
nn <- 20
incl <- 1:20
s <- 1
      tail <- seq(from=length(incl)-s+1, to=length(incl));
tail
      ss <- c(incl[tail], incl[-tail]);
ss
lastRow <- incl
      tail <- seq(from=length(lastRow)-s+1, to=length(lastRow));
      lastRow <- idxs[ceiling(h),];
lastRow
lastRow <- 1:20
      ss <- c(lastRow[tail], lastRow[-tail]);
ss
      lastRow <- c(lastRow[tail], lastRow[-tail]);
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
rm(sets)
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
force <- TRUE
dev.off(); source("rocH.Rex")
force <- TRUE
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
force <- FALSE
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
sets[[4]][["hTp_0.0100"]][29,]
sets[[4]][["hTp_0.0100"]]
sets[[4]][["hTp_0.0100"]][26,]
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
sets[[4]][["hTp_0.0100"]][26,]
sets[[3]][["hTp_0.0100"]][26,]
sets[[2]][["hTp_0.0100"]][26,]
sets[[1]][["hTp_0.0100"]][26,]
sets[[1]][["hTp_0.0100"]]
sets[[1]][["hTp_0.0100"]][6:9,]
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
sets[[1]][["hTp_0.0100"]][6:9,]
sets[[2]][["hTp_0.0100"]][6:9,]
sets[[3]][["hTp_0.0100"]][6:9,]
sets[[4]][["hTp_0.0100"]][6:9,]
sets[[4]][["hTp_0.0100"]]
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
sets[[4]][["hTp_0.0100"]]
sets[[4]][["hTp_0.0100"]][40:44,]
sets[[3]][["hTp_0.0100"]][40:44,]
sets[[4]][["hTp_0.0100"]][40:44,]
sets[[4]][["hTp_0.0100"]][40:44,]
gc()
save.image()
sets[[4]][["hTp_0.0100"]][40:44,]
sets[[3]][["hTp_0.0100"]][40:44,]
sets[[2]][["hTp_0.0100"]][40:44,]
sets[[1]][["hTp_0.0100"]][40:44,]
sets[[1]][["hTp_0.0100"]][1,]
sets[[2]][["hTp_0.0100"]][1,]
sets[[3]][["hTp_0.0100"]][1,]
sets[[4]][["hTp_0.0100"]][1,]
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
saveObject(list(sets=sets), "TPvResolutionAtFP1_0.RData", compress=FALSE)
gc()
rm(sets)
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
source("roc.Rex")
source("roc.Rex")
dev.off(); source("roc.Rex")
plot(1:length(niceCols), col=niceCols, pch=19, cex=3)
dev.off(); source("roc.Rex")
sets[[1]]$col <- niceCols[10]
dev.off(); source("roc.Rex")
sets[[1]]$col <- niceCols[6]
dev.off(); source("roc.Rex")
sets[[3]]$col <- niceCols[9]
dev.off(); source("roc.Rex")
sets[[2]]$col <- niceCols[5]
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
rm(sets)
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
rm(sets)
dev.off(); source("roc.Rex")
  legend("bottomright", pch=19, lty=ltys, lwd=4, col=cols, legend=labels, bg="#eeeeee");
references
rm(sets); dev.off(); source("roc.Rex")
rm(sets); dev.off(); source("roc.Rex")
rm(sets); dev.off(); source("roc.Rex")
rm(sets); source("roc.Rex")
sets[[5]] <- NULL
sets[[3]] <- NULL
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
rm(sets)
dev.off(); source("roc.Rex")
dev.off(); source("roc.Rex")
sets[[2]]$col <- niceCols[5]
sets[[3]]$col <- niceCols[10]
dev.off(); source("roc.Rex")
library(aroma.affymetrix)
chipType <- "Mapping250K_Nsp"
cdf <- AffymetrixCdfFile$fromChipType(chipType)
cdf
pathname <- file.choose()
pathname
verbose <- Arguments$getVerbose(-5)
timestampOn(verbose)
ces <- CnChipEffectSet$importFromDChip(pathname, cdf=cdf, verbose=verbose)
gc()
ces
gi <- getGenomeInformation(cdf)
xUnits <- getUnitsOnChromosome(gi, 23)
str(xUnits)
theta <- extractMatrix(ces, units=xUnits, verbose=verbose)
saveObject(list(theta=theta), sprintf("%s.RData" getFullName(ces)), compress=FALSE)
saveObject(list(theta=theta), sprintf("%s.RData", getFullName(ces)), compress=FALSE)
dev.off(); source("roc.Rex")
source("roc.Rex")
rm(sets)
source("roc.Rex")
source("roc.Rex")
names(sets)
sets[[3]]$name
sets[[3]]$name <- "dChip,no-outliers"
source("roc.Rex")
rm(sets)
source("roc.Rex")
source("roc.Rex")
rm(sets)
source("roc.Rex")
names(sets)
rm(sets)
source("roc.Rex")
source("rocH.Rex")
force <- FALSE
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
axis
axis
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off()
dev.off()
dev.off(); source("rocH.Rex")
source("rocH.Rex")
source("hbCEU.Rex")
cf <- getFile(cs, 2)
plotAllelicCrosstalk(cf, verbose=verbose)
source("hbCEU.Rex")
plotAllelicCrosstalk(cf, verbose=verbose)
par(ask=TRUE)
par(ask=TRUE)
plotAllelicCrosstalk(cf, verbose=verbose)
source("hbCEU.Rex")
plotAllelicCrosstalk(cf, verbose=verbose)
source("hbCEU.Rex")
plotAllelicCrosstalk(cf, verbose=verbose)
plotAllelicCrosstalk(cf, verbose=verbose)
par(ask=T)
plotAllelicCrosstalk(cf, verbose=verbose)
5/29
5608*59
source("roc.Rex")
set
str(set)
o <- order(x)
M <- set$M[o]
plot(x[o][1:16], M[1:16])
dev.off()
plot(x[o][1:16], M[1:16])
plot(M[1:16])
plot(M[1:16], ylab="M", xlab="SNP index")
plot(M[1:16], ylab="M", xlab="position")
M2 <- apply(matrix(M, nrow=2), MARGIN=2, FUN=median)
x2 <- apply(matrix(1:16, nrow=2), MARGIN=2, FUN=median)
points(x2,M2, pch=19)
x2
M2
M2 <- apply(matrix(M[,1], nrow=2), MARGIN=2, FUN=median)
M2 <- apply(matrix(M[1:16,1], nrow=2), MARGIN=2, FUN=median)
M[1:16,1]
str(M)
M2 <- apply(matrix(M[1:16], nrow=2), MARGIN=2, FUN=median)
points(x2,M2, pch=19)
M2 <- apply(matrix(M[1:16], nrow=2), MARGIN=2, FUN=median)
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position")
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position")
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position", bty="n")
plot(1:16, M[1:16], ylab="M", pch=19, cex=2, xlab="position", bty="n")
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position", axes=FALSE)
axis(side=2)
points(x2,M2, pch=18, cex=2, col="red")
lines(x2,M2, pch=18, cex=2, col="red")
lines(x2,M2, pch=18, lwd=2, col="red")
lines(M[1:16], pch=18, lwd=2, col="black")
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position", axes=FALSE); axis(side=1); lines(M[1:16], pch=18, lwd=2, col="black")
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position", axes=FALSE); axis(side=2); lines(M[1:16], pch=18, lwd=2, col="black")
par(cex.lab=1.5)
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position", axes=FALSE); axis(side=2); lines(M[1:16], pch=18, lwd=2, col="black")
par(cex.lab=1.5, cex.axis=1.2)
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position", axes=FALSE); axis(side=2); lines(M[1:16], pch=18, lwd=2, col="black")
par(cex.lab=1.5, cex.axis=1)
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position", axes=FALSE); axis(side=2); lines(M[1:16], pch=18, lwd=2, col="black")
points(x2,M2, pch=18, cex=2, col="red")
lines(x2,M2, pch=18, lwd=2, col="red")
M2 <- apply(matrix(M[1:16], nrow=3), MARGIN=2, FUN=median)
M2 <- apply(matrix(M[1:16], nrow=2), MARGIN=2, FUN=median)
M3 <- apply(matrix(M[1:16], nrow=3), MARGIN=2, FUN=median)
x3 <- apply(matrix(1:16, nrow=3), MARGIN=2, FUN=median)
points(x3,M3, pch=18, cex=2, col="blue")
x3
points(x3[1:5],M3[1:5], pch=18, cex=2, col="blue")
lines(x3[1:5],M3[1:5], lwd=2, col="blue")
points(x2,M2, pch=18, cex=2, col="red"); lines(x2,M2, pch=18, lwd=2, col="red")
plot(M[1:16], ylab="M", pch=19, cex=2, xlab="position", axes=FALSE); axis(side=2); lines(M[1:16], pch=18, lwd=2, col="black")
points(x2,M2, pch=18, cex=2, col="red"); lines(x2,M2, pch=18, lwd=2, col="red")
points(x3[1:5],M3[1:5], pch=18, cex=2, col="blue"); lines(x3[1:5],M3[1:5], lwd=2, col="blue")
dev.off()
source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
dev.off(); source("rocH.Rex")
source("roc.Rex")
source("roc.Rex")
source("roc.Rex")
source("roc.Rex")
source("roc.Rex")
par(ask=T)
source("roc.Rex")
source("roc.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
dev.off()
source("rocH.Rex")
traceback()
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
str(sets)
str(sets[[1]][[4]])
str(sets[[1]][["hTp_0.0100"]])
sets[[1]][["hTp_0.0100"]]
sets[[2]][["hTp_0.0100"]]
sets[[3]][["hTp_0.0100"]]
dev.off()
sets[[3]][["hTp_0.0100"]]
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
dev.off()
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
source("rocH.Rex")
dev.off()
source("rocH.Rex")
1350*7
1350*6.7
1350*7.5
7/6.7
300+137.5
437.5
437.5*7
437.5/7
437.5/7*1e3
437.5/7*1e3-(12*1350)
437.5/7*1e3-(12*2000)
(437.5/7*1e3-(12*2000))
(437.5/7*1e3-(12*2000))*6.7
4.3
4.4
0.044*450000
0.044*450000/12
